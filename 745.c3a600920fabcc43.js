"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[745],{1745:(rt,C,s)=>{s.r(C),s.d(C,{MinuteModule:()=>lt});var I=s(4521),g=s(7579),a=s(2722),c=s(3075),m=s(8966),t=s(5e3),w=s(1135),_=s(4004),v=s(262),b=s(9646),D=s(2340),F=s(520);const p=D.N.base_url;let f=(()=>{class n{constructor(e){this._http=e,this._onlistenSubject=new g.x,this._minutes=new w.X(null)}get _minutes$(){return this._minutes.asObservable()}create(e){return this._http.post(`${p}/minute/create`,e,this._getHeaders).pipe((0,_.U)(i=>i.statusCode?i.statusCode:500),(0,v.K)(i=>(0,b.of)(i.status)))}disable(e){return this._http.delete(`${p}/minute/disable/${e}`,this._getHeaders).pipe((0,_.U)(i=>i.statusCode?i.statusCode:500),(0,v.K)(i=>(0,b.of)(i.status)))}download(e){return this._http.get(`${p.replace("/api","")}/uploads/${e}`,{responseType:"blob"})}findMinutes(e){return this._http.post(`${p}/minute/find`,e,this._getHeaders).pipe((0,_.U)(i=>i.statusCode&&200==i.statusCode?(this._minutes.next(i.minutes),{page:i.page,total:i.total,pages:i.pages,minutes:i.minutes}):null),(0,v.K)(i=>(0,b.of)(null)))}listenDialog(){this._onlistenSubject.next()}get dialogStatus(){return this._onlistenSubject.asObservable()}get _getToken(){return localStorage.getItem("x-token")||""}get _getHeaders(){return{headers:{"x-token":this._getToken}}}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(F.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var x=s(1937),T=s(7322),U=s(7531),d=s(9808),h=s(7423);function N(n,l){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Este campo es requerido. "),t.qZA())}function L(n,l){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"La im\xe1gen debe ser en extensi\xf3n .jpg, .png o .jpeg"),t.qZA())}function Q(n,l){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"La im\xe1gen debe pesar menos o igual a 7mb"),t.qZA())}let Y=(()=>{class n{constructor(e,i,o,r,u){this.data=e,this._fb=i,this._dialogRef=o,this._service=r,this._snackbar=u,this.invalidSize=!1,this.invalidExtention=!1,this._unsubscribeAll=new g.x}ngOnInit(){this.initForm()}initForm(){this.form=this._fb.group({description:["",c.kI.required]})}uploadMinute(){if(this.form.invalid)return Object.values(this.form.controls).forEach(o=>o.markAsTouched());const{description:e}=this.form.getRawValue(),i=new FormData;i.append("description",e),i.append("evidence",this.selectedFile.fileRaw,this.selectedFile.filename),this._service.create(i).pipe((0,a.R)(this._unsubscribeAll)).subscribe(o=>{const r=200===o?"Se ha cargado el acta exit\xf3samente.":"Ha ocurrido un error al cargar el acta.";this.onClose(200===o),this._snackbar.open(r)})}onFileSelected(e){if(this.selectedFile=null,e.target.files&&e.target.files[0]){const o=["application/pdf"],r=e.target.files[0];if((null==r?void 0:r.size)>2e6)return void(this.invalidSize=!0);if(!o.includes(null==r?void 0:r.type))return void(this.invalidExtention=!0);const u=r.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\xf1/g,"n").replace(/\s+/g,"_").replace(/[^\w.-]/g,"");this.selectedFile={fileRaw:r,filename:u}}}onClose(e=!1){this._dialogRef.close(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.WI),t.Y36(c.qu),t.Y36(m.so),t.Y36(f),t.Y36(x.cw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dialog"]],decls:15,vars:6,consts:[["mat-dialog-title",""],["name","form",3,"formGroup","ngSubmit"],["matInput","","placeholder","Description del acta","formControlName","description"],[4,"ngIf"],[1,"mt-4"],["type","file","name","image","accept",".pdf",3,"change"],["mat-dialog-actions",""],["mat-button","","type","button",3,"click"],["mat-flat-button","","type","submit",3,"color","disabled"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Subir acta"),t.qZA(),t.TgZ(2,"form",1),t.NdJ("ngSubmit",function(){return i.uploadMinute()}),t.TgZ(3,"mat-form-field"),t._UZ(4,"input",2),t.YNc(5,N,2,0,"mat-error",3),t.qZA(),t.TgZ(6,"div",4)(7,"input",5),t.NdJ("change",function(r){return i.onFileSelected(r)}),t.qZA(),t.YNc(8,L,2,0,"mat-error",3),t.YNc(9,Q,2,0,"mat-error",3),t.qZA(),t.TgZ(10,"div",6)(11,"button",7),t.NdJ("click",function(){return i.onClose()}),t._uU(12,"Cancelar"),t.qZA(),t.TgZ(13,"button",8),t._uU(14," Crear "),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(3),t.Q6J("ngIf",i.form.get("description").invalid&&i.form.get("description").touched),t.xp6(3),t.Q6J("ngIf",i.invalidExtention),t.xp6(1),t.Q6J("ngIf",i.invalidSize),t.xp6(4),t.Q6J("color","primary")("disabled",i.form.invalid||i.form.pristine||!i.selectedFile))},directives:[m.uh,c._Y,c.JL,c.sg,T.KE,U.Nt,c.Fj,c.JJ,c.u,d.O5,T.TO,m.H8,h.lW],styles:[".mat-form-field[_ngcontent-%COMP%]{display:grid!important;width:100%;margin-bottom:10px}.doc-file[_ngcontent-%COMP%]{color:#fff;text-align:center;font-weight:700;font-style:italic}"]}),n})();var S=s(7495),Z=s(5245),k=s(3844),y=s(6087),M=s(4847),J=s(7238);function R(n,l){1&n&&(t.TgZ(0,"div"),t._uU(1,"Estado"),t.qZA())}function O(n,l){1&n&&t._UZ(0,"mat-icon",16),2&n&&t.Q6J("matTooltip","Inhabilitado")}function z(n,l){1&n&&t._UZ(0,"mat-icon",17),2&n&&t.Q6J("matTooltip","Habilitado")}function j(n,l){if(1&n&&(t.TgZ(0,"div",9),t.YNc(1,O,1,1,"mat-icon",14),t.YNc(2,z,1,1,"mat-icon",15),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==e?null:e.DeletedAt),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.DeletedAt))}}function E(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(3).disableMinute(o.Id)}),t._UZ(1,"mat-icon",19),t.qZA()}2&n&&t.Q6J("matTooltip","Deshabilitar acta")}function H(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8),t._uU(5," NO THUMB "),t.qZA()()(),t.TgZ(6,"div",9),t._uU(7),t.qZA(),t.TgZ(8,"div",9),t._uU(9),t.qZA(),t.TgZ(10,"div",9),t._uU(11),t.qZA(),t.YNc(12,j,3,2,"div",10),t.TgZ(13,"div")(14,"button",11),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(3).downloadMinute(null==r?null:r.Filename)}),t._UZ(15,"mat-icon",12),t.qZA(),t.YNc(16,E,2,1,"button",13),t.qZA()(),t.BQk()}if(2&n){const e=l.$implicit,i=t.oxw(3);t.xp6(7),t.hij(" ",null==e?null:e.Author," "),t.xp6(2),t.hij(" ",null==e?null:e.Description," "),t.xp6(2),t.hij(" ",i.convertDate(null==e?null:e.CreatedAt)," "),t.xp6(1),t.Q6J("ngIf",1===(null==i.user?null:i.user.role)),t.xp6(2),t.Q6J("matTooltip","Descargar acta")("disabled",null!==(null==e?null:e.DeletedAt)),t.xp6(2),t.Q6J("ngIf",3!==(null==i.user?null:i.user.role)&&null===(null==e?null:e.DeletedAt))}}function $(n,l){if(1&n&&(t.ynx(0),t.YNc(1,H,17,7,"ng-container",4),t.BQk()),2&n){const e=l.ngIf,i=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e)("ngForTrackBy",i.trackByFn)}}const B=function(n){return{"pointer-events-none":n}};function G(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"div",1)(2,"div",2),t._UZ(3,"div"),t.TgZ(4,"div"),t._uU(5,"Autor"),t.qZA(),t.TgZ(6,"div"),t._uU(7,"Titulo"),t.qZA(),t.TgZ(8,"div"),t._uU(9,"Fecha de subida"),t.qZA(),t.YNc(10,R,2,0,"div",0),t.TgZ(11,"div"),t._uU(12,"Opciones"),t.qZA()(),t.YNc(13,$,2,2,"ng-container",0),t.ALo(14,"async"),t.qZA(),t._UZ(15,"mat-paginator",3),t.BQk()),2&n){const e=t.oxw();t.xp6(10),t.Q6J("ngIf",1===(null==e.user?null:e.user.role)),t.xp6(3),t.Q6J("ngIf",t.lcZ(14,5,e.minutes$)),t.xp6(2),t.Q6J("length",e.count)("pageSizeOptions",e.pageSizeOptions)("ngClass",t.VKq(7,B,e.loading))}}function K(n,l){1&n&&(t.ynx(0),t.TgZ(1,"div",20),t._UZ(2,"mat-icon",21),t.TgZ(3,"div",22),t._uU(4," No se han encontrado actas. "),t.qZA()(),t.BQk()),2&n&&(t.xp6(2),t.Q6J("svgIcon","heroicons_outline:document"))}let W=(()=>{class n{constructor(e,i,o,r){this._user=e,this._minute=i,this._snackbar=o,this._changeDetectorRef=r,this.minutes=[],this.page=1,this.count=0,this.pages=0,this.pageSize=10,this.pageSizeOptions=[10,15,25],this._unsubscribeAll=new g.x}ngOnInit(){this._onGetSession(),this._onGetMinutes(),this._onListenDialog()}disableMinute(e){this._minute.disable(e).pipe((0,a.R)(this._unsubscribeAll)).subscribe(i=>{const o=200===i?"Se ha deshabilitado el acta exit\xf3samente":"Ha ocurrido un error al deshabilitar el acta.";this._onGetMinutes(),this._snackbar.open(o)})}downloadMinute(e){this._minute.download(e).pipe((0,a.R)(this._unsubscribeAll)).subscribe(i=>{const o=null==e?void 0:e.replace(/.*_/,""),r=new Blob([i],{type:"application/pdf"}),u=window.URL.createObjectURL(r),A=document.createElement("a");A.href=u,A.download=o,A.click(),window.URL.revokeObjectURL(u)})}convertDate(e){return(0,x.Mu)(e)}_onGetSession(){this._user.user$.pipe((0,a.R)(this._unsubscribeAll)).subscribe(e=>{this.user=e})}_onGetMinutes(e=1,i=10){try{this.loading=!0,this._minute.findMinutes({page:e,pageSize:i}).pipe((0,a.R)(this._unsubscribeAll)).subscribe(o=>{this.loading=!1,this.page=o.page,this.count=o.total,this.pages=o.pages,this.minutes=o.minutes,this._changeDetectorRef.markForCheck()}),this.minutes$=this._minute._minutes$}catch(o){console.log(o)}}_onListenDialog(){this._minute.dialogStatus.pipe((0,a.R)(this._unsubscribeAll)).subscribe(e=>{this._onGetMinutes(this.page,this.pageSize)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S.K),t.Y36(f),t.Y36(x.cw),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["minute-list"]],viewQuery:function(e,i){if(1&e&&(t.Gf(y.NW,5),t.Gf(M.YE,5)),2&e){let o;t.iGM(o=t.CRH())&&(i._paginator=o.first),t.iGM(o=t.CRH())&&(i._sort=o.first)}},decls:2,vars:2,consts:[[4,"ngIf"],[1,"grid"],["matSort","","matSortDisableClear","",1,"inventory-grid-minute","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"length","pageSizeOptions","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inventory-grid-minute","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b"],[1,"flex","items-center"],[1,"relative","flex","flex-0","items-center","justify-center","w-12","h-12","mr-6","rounded","overflow-hidden","border"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"truncate"],["class","truncate",4,"ngIf"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6","ml-2",3,"matTooltip","disabled","click"],["svgIcon","heroicons_outline:folder-download"],["mat-stroked-button","","class","min-w-10 min-h-7 h-7 px-2 leading-6 ml-2",3,"matTooltip","click",4,"ngIf"],["style","color: red","svgIcon","heroicons_outline:x-circle",3,"matTooltip",4,"ngIf"],["style","color: green","svgIcon","heroicons_outline:check-circle",3,"matTooltip",4,"ngIf"],["svgIcon","heroicons_outline:x-circle",2,"color","red",3,"matTooltip"],["svgIcon","heroicons_outline:check-circle",2,"color","green",3,"matTooltip"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6","ml-2",3,"matTooltip","click"],["svgIcon","heroicons_outline:folder-remove"],[1,"flex","flex-col","flex-auto","items-center","justify-center",2,"margin-top","17%"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(e,i){1&e&&(t.YNc(0,G,16,9,"ng-container",0),t.YNc(1,K,5,1,"ng-container",0)),2&e&&(t.Q6J("ngIf",i.count),t.xp6(1),t.Q6J("ngIf",!i.count&&!i.loading))},directives:[d.O5,M.YE,d.sg,Z.Hw,J.gM,h.lW,y.NW,d.mk],pipes:[d.Ov],styles:[".inventory-grid-minute{grid-template-columns:3.5fr 1.5fr 1fr}@media (min-width: 600px){.inventory-grid-minute{grid-template-columns:.5fr 1.5fr 2fr 1fr .5fr 1fr}}@media (min-width: 960px){.inventory-grid-minute{grid-template-columns:.5fr 1.5fr 2fr 1fr .5fr 1fr}}@media (min-width: 1280px){.inventory-grid-minute{grid-template-columns:.5fr 1.5fr 2fr 1fr .5fr 1fr}}.minute-photo-list{height:100%;width:100%}\n"],encapsulation:2,data:{animation:k.L},changeDetection:0}),n})();function X(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().openDialog()}),t._UZ(1,"mat-icon",8),t.TgZ(2,"span",9),t._uU(3,"Subir acta"),t.qZA()()}2&n&&(t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"))}const P=[{path:"",component:(()=>{class n{constructor(e,i,o){this._user=e,this._dialog=i,this._minute=o,this._unsubscribeAll=new g.x}ngOnInit(){this._onGetSession()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openDialog(){this._dialog.open(Y,{width:"500px"}).afterClosed().pipe((0,a.R)(this._unsubscribeAll)).subscribe(i=>this._minute.listenDialog())}_onGetSession(){this._user.user$.pipe((0,a.R)(this._unsubscribeAll)).subscribe(e=>{this.user=e})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S.K),t.Y36(m.uw),t.Y36(f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-minute"]],decls:9,vars:1,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-flat-button","","class","ml-4 mr-4",3,"color","click",4,"ngIf"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],["mat-flat-button","",1,"ml-4","mr-4",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Actas"),t.qZA(),t.TgZ(4,"div",3),t.YNc(5,X,4,2,"button",4),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6),t._UZ(8,"minute-list"),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("ngIf",1===(null==i.user?null:i.user.role)))},directives:[d.O5,h.lW,Z.Hw,W],styles:[""]}),n})()}];let V=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[I.Bz.forChild(P)],I.Bz]}),n})();var q=s(4466),tt=s(7446),et=s(2181),nt=s(5899),it=s(508),ot=s(4102),st=s(2368);let lt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[f],imports:[[q.m,V,h.ot,tt.p9,T.lN,Z.Ps,U.c,et.Tx,y.TU,nt.Cv,it.si,M.JX,ot.LD,st.rP,J.AV,m.Is]]}),n})()}}]);